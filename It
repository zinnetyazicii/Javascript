Add-Type -AssemblyName System.Windows.Forms Add-Type -AssemblyName System.Drawing # Form Tasarımı $Form = New-Object System.Windows.Forms.Form $Form.Text = "Active Directory Kullanıcı Bilgisi" $Form.Size = New-Object System.Drawing.Size(500, 600) $Form.StartPosition = "CenterScreen" $Form.BackColor = [System.Drawing.Color]::FromArgb(240, 240, 240) # Kullanıcı Adı Etiketi ve TextBox

$Label = New-Object System.Windows.Forms.Label $Label.Text = "Kullanıcı Adı:" $Label.Location = New-Object System.Drawing.Point(20, 20) $Label.AutoSize = $true $Form.Controls.Add($Label)  $TextBox = New-Object System.Windows.Forms.TextBox $TextBox.Location = New-Object System.Drawing.Point(120, 18) $TextBox.Width = 200 $Form.Controls.Add($TextBox)  # Butonlar Paneli $ButtonPanel = New-Object System.Windows.Forms.Panel $ButtonPanel.Location = New-Object System.Drawing.Point(20, 50) $ButtonPanel.Size = New-Object System.Drawing.Size(450, 50) $Form.Controls.Add($ButtonPanel)  $UsersButton = New-Object System.Windows.Forms.Button $UsersButton.Text = "Kullanıcılar" $UsersButton.Location = New-Object System.Drawing.Point(0, 0) $UsersButton.Size = New-Object System.Drawing.Size(150, 40) $UsersButton.BackColor = [System.Drawing.Color]::FromArgb(50, 150, 250) $UsersButton.ForeColor = [System.Drawing.Color]::White $ButtonPanel.Controls.Add($UsersButton)  $GroupsButton = New-Object System.Windows.Forms.Button $GroupsButton.Text = "Gruplar" $GroupsButton.Location = New-Object System.Drawing.Point(160, 0) $GroupsButton.Size = New-Object System.Drawing.Size(150, 40) $GroupsButton.BackColor = [System.Drawing.Color]::FromArgb(50, 150, 250) $GroupsButton.ForeColor = [System.Drawing.Color]::White $ButtonPanel.Controls.Add($GroupsButton)  # Kullanıcı Bilgilerini Gösteren ListBox $ListBox = New-Object System.Windows.Forms.ListBox $ListBox.Location = New-Object System.Drawing.Point(20, 110) $ListBox.Size = New-Object System.Drawing.Size(450, 400) $Form.Controls.Add($ListBox)  # Kullanıcılar Butonu Tıklanırsa $UsersButton.Add_Click({     $Username = $TextBox.Text     if ($Username -ne "") {         Try {             $User = Get-ADUser -Identity $Username -Properties *             $ListBox.Items.Clear()             $ListBox.Items.Add("👤 Adı Soyadı: $($User.DisplayName)")             $ListBox.Items.Add("📧 E-Posta: $($User.Mail)")             $ListBox.Items.Add("📞 Telefon: $($User.TelephoneNumber)")             $ListBox.Items.Add("🏢 Departman: $($User.Department)")

# Hesap Durumu             $AccountStatus = if ($User.Enabled) { "✅ Hesap Etkin" } else { "❌ Hesap Devre Dışı" }             $ListBox.Items.Add($AccountStatus)               # Hesap Kilitli mi?             $LockedStatus = if ($User.LockoutStatus) { "🔒 Hesap Kilitli" } else { "🔓 Hesap Kilitli Değil" }             $ListBox.Items.Add($LockedStatus)           } Catch {             $ListBox.Items.Clear()             $ListBox.Items.Add("Hata: Kullanıcı bulunamadı!")         }     } else {         $ListBox.Items.Clear()         $ListBox.Items.Add("Lütfen bir kullanıcı adı girin.")     } })    # Gruplar Butonu Tıklanırsa $GroupsButton.Add_Click({     $Username = $TextBox.Text     if ($Username -ne "") {         Try {             $Groups = Get-ADUser -Identity $Username -Properties MemberOf | Select-Object ExpandProperty MemberOf             $ListBox.Items.Clear()             if ($Groups) {                 $ListBox.Items.Add("👥 Kullanıcının Grupları:")                 # CN= kısmını kaldır ve sadece grup adını listele                 $Groups | ForEach-Object {                      $CleanGroupName = ($_ -split ',')[0] -replace "^CN=", ""                     $ListBox.Items.Add($CleanGroupName)                  }             } else {                 $ListBox.Items.Add("Kullanıcı herhangi bir gruba üye değil.")             }         } Catch {             $ListBox.Items.Clear()             $ListBox.Items.Add("Hata: Kullanıcı bulunamadı!")         }     } else {

$ListBox.Items.Clear() $ListBox.Items.Add("Lütfen bir kullanıcı adı girin.") } }) # Formu Göster $Form.ShowDialog()


